{% extends 'base.html.twig' %}
{% block head %}
<link rel="stylesheet"href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.css"integrity="sha256-5veQuRbWaECuYxwap/IOE/DAwNxgm4ikX7nrgsqYp88="crossorigin="anonymous">
{% endblock %}
{% block body %}
    <div class="d-flex justify-content-center">
        <div class="scroll  container bg-secondary m-2 p-2 "style="border-radius:10px">
            <a class="btn btn-success  mt-2 mx-2 mb-2" href="{{ path('app_booking_index')}}">Reservations</a>
            <div class="mx-2 mt-1 pb-2" id="calendrier"></div>
        </div>
    </div>
    <script>
        window.onload = () => {
            let calendarElt = document.querySelector("#calendrier")
            let calendar = new FullCalendar.Calendar(calendarElt, {
                initialView: 'timeGridWeek', 
                locale: 'fr', 
                timeZone: 'Europe/Paris',  
                headerToolbar: { start:'prev, next today',center:'title',end: 'dayGridMonth, timeGridWeek'},
                events: {{ data|raw }}, editable: true,
                allDaySlot: false,
                slotMinTime: "08:00:00",
                slotMaxTime: "17:00:00",
                forceEventDuration: true, 
                hiddenDays:[0,6],
            });
            calendar.on('eventChange', (e) => {
                let url = `/api/${e.event.id}/edit`
                let donnees = {
                    "title": e.event.title,
                    "start": e.event.start,
                }
                let xhr = new XMLHttpRequest
                xhr.open("PUT", url)
                xhr.send(JSON.stringify(donnees))
            })
            calendar.render()
        }
    </script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.js"integrity="sha256-YicH/8aE660iEnJtgll3vT54dJApy3XkYmqNfGVFEzA="crossorigin="anonymous"></script>
{% endblock %}
